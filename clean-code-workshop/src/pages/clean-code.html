<section>
    <h2>Coder proprement</h2>
</section>
<section>
    <h3>Le nommage</h3>
    <section>
        <b>Significatif</b>
        <pre><code>compute()</code></pre>
        préférer
        <pre><code>getCartPrice()</code></pre> 
    </section>
    <section>
        <b>Eviter les codes, acronymes</b>
        <pre><code>psp</code></pre>
        préférer
        <pre><code>paymentSystemProvider</code></pre> 
    </section>
    <section>
        <b>Distinctions</b>
        <pre><code>price, preTaxPrice</code></pre>
        préférer
        <pre><code>taxInclusivePrice, preTaxPrice</code></pre> 
    </section>
    <section>
        <b>Un mot par concept</b>
        <pre><code>ShoppingList, ShoppingItems, ItemsToBuy, items, ...</code></pre>
        préférer
        <pre><code>Cart</code></pre>
    </section>
    <section>
        <b>Choisir des noms du métier</b>
        <pre><code>User</code></pre>
        préférer
        <pre><code>Buyer, Seller</code></pre>
    </section>
    <section>
        <p>Rendre le code expressif</p>
        <br/>
        <blockquote>Et si j'était nouveau ?</blockquote>
    </section>
</section>
<section>
    <section>
        <b>Fonctions courtes</b>
            <pre><code>public void updateQuality() {
for (int i = 0; i < items.length; i++) {
    if (!items[i].name.equals("Aged Brie")
            && !items[i].name.equals("Backstage passes to a TAFKAL80ETC concert")) {
        if (items[i].quality > 0) {
            if (!items[i].name.equals("Sulfuras, Hand of Ragnaros")) {
                items[i].quality = items[i].quality - 1;
            }
        }
    } else {
        if (items[i].quality < 50) {
            items[i].quality = items[i].quality + 1;

            if (items[i].name.equals("Backstage passes to a TAFKAL80ETC concert")) {
                if (items[i].sellIn < 11) {
                    if (items[i].quality < 50) {
                        items[i].quality = items[i].quality + 1;
                    }
                }

                if (items[i].sellIn < 6) {
                    if (items[i].quality < 50) {
        ...</code></pre>        
                préférer
        <pre><code>public void updateQuality() {
    Arrays.stream(items).forEach(item ->
        updateQuality(item)
    )
}</code></pre>
    </section>
    <section>
        <b>Fonction : un seul objectif</b>
        <pre><code>public void sendGreetings(String fileName, Date Date, String smtpHost, int smtpPort) {
    BufferedReader in = new BufferedReader(new FileReader(fileName));
    String str = "";
    str = in.readLine(); // skip header
    while ((str = in.readLine()) != null) {
        // Read customers
        String[] customerData = str.split(", ");
        Customer customer = new Customer(customerData[1], customerData[0],customerData[2], customerData[3]);
        if (customer.isBirthday(date)) {
            // Send mail
            String recipient = customer.getEmail();
            String body = "Happy Birthday, dear %NAME%".replace("%NAME%", customer.getFirstName());
            String subject = "Happy Birthday!";
            sendMessage(smtpHost, smtpPort, "sender@here.com",
            subject, body, recipient);
        }
    }
}</code></pre>
préférer
<pre><code>public void sendGreetings(Date date, List&lt;Customer&gt; customers ) {
        for(Customer customer : customers) {
            if (customer.isBirthday(date))
                messageService.sendBirthdayGreetingsMessage(customer);
        }
    }</code></pre>
    </section>
    <section>
        <b>Function : Un niveau d'abstraction (SLAP)</b>
        <pre><code>public void sendGreetings(Date date, String smtpHost, int smtpPort)  {
    Connection conn = DriverManager.getConnection(url, user, passwd);
    Statement state = conn.createStatement();
    ResultSet result = state.executeQuery("SELECT email, firstname, lastname, birthday FROM customer");
    while(result.next()){
        // Read customers
        Customer customer = new Customer(result.getString("email"), result.getString("firstname"), result.getString("lastname"), result.getTimestamp("birthdate"));
        if (customer.isBirthday(date)) {
            // Send mail
            String recipient = customer.getEmail();
            String body = "Happy Birthday, dear %NAME%".replace("%NAME%", customer.getFirstName());
            String subject = "Happy Birthday!";
            sendMessage(smtpHost, smtpPort, "sender@here.com",
            subject, body, recipient);
        }
    }
}</code></pre>
préférer
<pre><code>public void sendGreetings(Date date) {
        for(Customer customer : customerRepository.findAll()) {
            if (customer.isBirthday(date))
                messageService.sendBirthdayGreetingsMessage(customer);
        }
    }</code></pre>
    </section>
    <section>
        <b>Fonction : éviter les side effects</b>
        <pre><code>
if (customer.isBirthday(this.date)) {
    // Send mail
    String body = "Happy Birthday, dear %NAME%".replace("%NAME%", customer.getFirstName());
    MailService mailService = new MailService();
    mailService.setSmtpHost(smtpHost);
    mailService.setSmtpPort(smtpPort);
    mailService.sendMessage("sender@here.com", "Happy Birthday!, body, customer.getEmail());
</code></pre>
préférer
<pre><code>if (customer.isBirthday(this.date)) {
        // Send mail
        String body = "Happy Birthday, dear %NAME%".replace("%NAME%", customer.getFirstName());
        MailService mailService = new MailService(smtpHost, smtpPort);
        mailService.sendMessage("sender@here.com", "Happy Birthday!, body, customer.getEmail());
    }</code></pre>
    </section>
</section>
<section>
    <h2>Commentaires</h2>
    <section>
        <b>Ne doit pas compenser le mauvais code</b>
        <pre><code>public void sendGreetings(String fileName, XDate xDate,
String smtpHost, int smtpPort)
throws IOException, ParseException,
AddressException, MessagingException {

    BufferedReader in = new BufferedReader(new FileReader(fileName));
    String str = "";
    str = in.readLine(); // skip header
    while ((str = in.readLine()) != null) {
        // parse line
        String[] customerData = str.split(", ");
        Customer customer = new Customer(customerData[1], customerData[0],
                        customerData[2], customerData[3]);
        if (customer.isBirthday(xDate)) {
            // Send mail
            String recipient = customer.getEmail();
            String body = "Happy Birthday, dear %NAME%"
                            .replace("%NAME%", customer.getFirstName());
            String subject = "Happy Birthday!";
            sendMessage(smtpHost, smtpPort, "sender@here.com",
            subject, body, recipient);
        }
    }
}</code></pre>
    </section>
    <section>
        <b>Explique pourquoi</b>
        <pre><code>
String str = "";
str = in.readLine(); // skip header
while ((str = in.readLine()) != null) {
</code></pre>            
    </section>
    <section>
        <b>// TODO: </b>
        <p>Quand les recherchez-vous ?</p>
    </section>
</section>
<section>
    <section>
        <h2>Programmation Objet (et classes)</h2>
    </section>
    <section>
        <b>Cacher la structure interne</b>
        <pre><code>public void sendGreetings(String fileName, Date date, String smtpHost, int smtpPort)
                throws IOException, ParseException, AddressException, MessagingException {
...</code></pre>
    </section>
    <section>
        <b>Une seule responsabilité</b>
        <pre><code>public class GreetingService {

    public void sendGreetings(String fileName, Date date, String smtpHost, int smtpPort)
    throws IOException, ParseException, AddressException, MessagingException {
        for(Customer customer : readCustomersFromFile(fileName))
            if (customer.isBirthday(xDate)) {
                this.sendMail(customer, smtpHost, smtpPort);
            }
        }
    }

    private List&lt;Customer&gt; readCustomersFromFile(String filename) {
        BufferedReader in = new BufferedReader(new FileReader(fileName));
        String str = "";
        str = in.readLine(); // skip header
        List&lt;Customer&gt; customers = new ArrayList&lt;&gt;();
        while ((str = in.readLine()) != null) {
            // parse line
            String[] customerData = str.split(", ");
            customers.add(new Customer(customerData[1], customerData[0],
                            customerData[2], customerData[3]));
        }
        return customers
    }

    private void sendMail(Customer customer, String smtpHost, int smtpPort) {
        // Send mail
        String recipient = customer.getEmail();
        String body = "Happy Birthday, dear %NAME%"
                        .replace("%NAME%", customer.getFirstName());
        String subject = "Happy Birthday!";
        sendMessage(smtpHost, smtpPort, "sender@here.com",
        subject, body, recipient);
    }
}</code></pre>
    </section>
    <section>
        <b>Eviter l'héritage</b>
        <img alt="inheritance" src="images/inheritance.png" />
    </section>
    <section>
        <b>Favoriser la composition</b>
        <img alt="composition" src="images/composition.png" />
    </section>
</section>